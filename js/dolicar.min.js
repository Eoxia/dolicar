window.dolicar||(window.dolicar={},window.dolicar.scriptsLoaded=!1),window.dolicar.scriptsLoaded||(window.dolicar.init=function(){window.dolicar.load_list_script()},window.dolicar.load_list_script=function(){if(!window.dolicar.scriptsLoaded){var o=void 0,t=void 0;for(o in window.dolicar)for(t in window.dolicar[o].init&&window.dolicar[o].init(),window.dolicar[o])window.dolicar[o]&&window.dolicar[o][t]&&window.dolicar[o][t].init&&window.dolicar[o][t].init();window.dolicar.scriptsLoaded=!0}},window.dolicar.refresh=function(){var o=void 0,t=void 0;for(o in window.dolicar)for(t in window.dolicar[o].refresh&&window.dolicar[o].refresh(),window.dolicar[o])window.dolicar[o]&&window.dolicar[o][t]&&window.dolicar[o][t].refresh&&window.dolicar[o][t].refresh()},$(document).ready(window.dolicar.init)),window.dolicar.registrationcertificate={},window.dolicar.registrationcertificate.init=function(){window.dolicar.registrationcertificate.event()},window.dolicar.registrationcertificate.event=function(){$(document).on("change","#fk_product",window.dolicar.registrationcertificate.actualizeBrand),$(document).on("change","#fk_product",window.dolicar.registrationcertificate.actualizeProductlot),$(document).ready(()=>{$(document).find(".field_fk_soc .butActionNew").attr("target","_blank"),$(document).find(".field_fk_project .butActionNew").attr("target","_blank")}),$("#public-vehicle-log-book-form").on("submit",function(o){o.preventDefault(),$(this).find(".public-vehicle-log-book-validate").hasClass("button-disable")||window.dolicar.registrationcertificate.createPublicVehicleLogBook()}),$(document).on("touchstart mousedown",".canvas-signature",function(){window.saturne.toolbox.removeAddButtonClass("public-vehicle-log-book-validate","button-grey button-disable","button-blue")}),$(document).on("click",".signature-erase",function(){window.saturne.toolbox.removeAddButtonClass("public-vehicle-log-book-validate","button-blue","button-grey button-disable")})},window.dolicar.registrationcertificate.actualizeBrand=function(o){var t=$('input[name="token"]').val(),i=document.getElementById("registrationcertificatefr_create")?document.getElementById("registrationcertificatefr_create"):document.getElementById("registrationcertificatefr_edit"),i=new FormData(i).get("fk_product"),e=window.saturne.toolbox.getQuerySeparator(document.URL);$.ajax({url:document.URL+e+"subaction=getProductBrand&token="+t,data:JSON.stringify({productId:i}),type:"POST",processData:!1,contentType:!1,success:function(o){$("#d1_vehicle_brand").attr("value",$(o).find(".car-brand").val()),$("#d1_vehicle_brand").prop("readonly",!0)}})},window.dolicar.registrationcertificate.actualizeProductlot=function(o){var t=$('input[name="token"]').val(),i=document.getElementById("registrationcertificatefr_create")?document.getElementById("registrationcertificatefr_create"):document.getElementById("registrationcertificatefr_edit"),i=new FormData(i),e=i.get("fk_product");let n=i.get("action");"update"==n&&(n="edit");i=window.saturne.toolbox.getQuerySeparator(document.URL);window.saturne.loader.display($(".lot-content")),$.ajax({url:document.URL+i+"action="+n+"&fk_product="+e+"&token="+t,type:"POST",processData:!1,contentType:!1,success:function(o){$(".lot-container").html($(o).find(".lot-content")),$(".wpeo-loader").removeClass("wpeo-loader")}})},window.dolicar.registrationcertificate.createPublicVehicleLogBook=function(){var o,t=window.saturne.toolbox.getToken(),i=window.saturne.toolbox.getQuerySeparator(document.URL),e=new FormData($("#public-vehicle-log-book-form")[0]);window.saturne.signature.canvas&&(o=window.saturne.signature.canvas.toDataURL(),e.append("signature",JSON.stringify(o))),$.ajax({url:document.URL+i+"action=add&token="+t,type:"POST",processData:!1,contentType:!1,data:e,success:function(){$(".card__confirmation").css("display","flex"),$(".public-vehicle-log-book-confirmation-close").on("click",function(){$(".card__confirmation").css("display","none"),window.location.reload()})},error:function(){}})};